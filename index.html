<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Tiny Wins">
    <meta name="theme-color" content="#667eea">
    <meta name="description" content="Small steps, big changes. AI-powered tasks with your dragon or wolf companion.">
    <!-- Prevent zoom on double tap -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    
    <!-- iOS splash screen -->
    <link rel="apple-touch-startup-image" href="icons/splash.png">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/Task/manifest.json">
    <!-- Add this in your <head> section -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ‰</text></svg>">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-180x180.png">
    <title>Tiny Wins - Dragon & Wolf Companions</title>
    <link rel="stylesheet" href="main.css">

    
</head>
<body>
    <div id="install-prompt" class="install-prompt hidden">
        <div class="install-content">
            <span>ğŸ“± Install Tiny Wins for offline access!</span>
            <button id="install-btn" class="install-button">Install</button>
            <button id="dismiss-install" class="dismiss-btn">âœ•</button>
        </div>
    </div>

    <!-- Touch feedback -->
    <div id="touch-feedback" class="touch-feedback"></div>
    <!-- Auth Section -->
    <div id="auth-section" class="auth-container">
        <div class="auth-box">
            <h1>ğŸ‰ Tiny Wins ğŸº</h1>
            <p>Your companion awaits</p>
            
            <div id="login-form">
                <input type="email" id="email" placeholder="Email" />
                <input type="password" id="password" placeholder="Password" />
                <button id="signin-btn">Sign In</button>
                <button id="signup-btn" class="secondary">Create Account</button>
            </div>
            
            <div id="pet-selection" class="hidden">
                <h3>Choose Your Companion</h3>
                <div class="pet-options">
                    <div class="pet-option" data-pet="dragon">
                        <div class="pet-emoji">ğŸ‰</div>
                        <div>Dragon</div>
                    </div>
                    <div class="pet-option" data-pet="wolf">
                        <div class="pet-emoji">ğŸº</div>
                        <div>Wolf</div>
                    </div>
                </div>
                <button id="select-pet-btn" class="hidden">Start Journey</button>
            </div>
        </div>
    </div>

    <!-- Main App (hidden until auth) -->
    <div id="app-section" class="hidden">
        <header>
            <div class="header-top">
                <h1 id="app-title">ğŸ‰ Tiny Wins</h1>
                <button id="logout-btn" class="logout">Logout</button>
            </div>
            <p>One small step at a time with your <span id="current-pet-type">dragon</span></p>
        </header>

        <div class="pet-section">
            <div class="pet-container">
                <div id="pet" class="pet stage-1">ğŸ¥š</div>
                <div class="pet-name" id="pet-name">Your Companion</div>
                <div class="level">Level <span id="level">1</span></div>
                <div class="xp-bar">
                    <div id="xp-fill" class="xp-fill"></div>
                </div>
                <div class="xp-text"><span id="xp">0</span> / <span id="xp-needed">5</span> XP</div>
            </div>
        </div>

        <div class="task-section">
            <h2>Next Tiny Task</h2>
            <div id="current-task" class="task-card">
                <div class="task-text">Loading AI task...</div>
                <div class="task-time">â±ï¸ <span id="task-time">1 min</span></div>
            </div>
            
            <button id="complete-task" class="complete-btn">I Did It! âœ…</button>
            <button id="skip-task" class="skip-btn">Too Much Right Now ğŸ”„</button>
            <button id="regenerate-task" class="regenerate-btn">Generate New Task ğŸ¯</button>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="tasks-today">0</div>
                <div class="stat-label">Today</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="streak">0</div>
                <div class="stat-label">Streak</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-tasks">0</div>
                <div class="stat-label">Total</div>
            </div>
        </div>

        <div class="recent-tasks">
            <h3>Recent Wins</h3>
            <div id="recent-list"></div>
        </div>
    </div>

    <script type="module" src="script.js"></script>
    <script type="module" src="script.js"></script>
<script>
    // Handle install prompt
    let deferredPrompt;
    const installPrompt = document.getElementById('install-prompt');
    const installBtn = document.getElementById('install-btn');
    const dismissInstall = document.getElementById('dismiss-install');

    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        installPrompt.classList.remove('hidden');
    });

    installBtn.addEventListener('click', async () => {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            console.log(`User response: ${outcome}`);
            deferredPrompt = null;
            installPrompt.classList.add('hidden');
        }
    });

    dismissInstall.addEventListener('click', () => {
        installPrompt.classList.add('hidden');
        deferredPrompt = null;
    });
</script>
</body>
</body>
</html>